-- Tabla CLIENTE
CREATE TABLE CLIENTE (
    RUT_CLIENT VARCHAR(10) PRIMARY KEY,
    TIPO_CLIENT VARCHAR(20),
    NOM_CLIENT VARCHAR(100),
    TELMOVIL_CLIENT VARCHAR(15),
    DIRECCION_CLIENT VARCHAR(100),
    COMUNA_CLIENT VARCHAR(25),
    CIUDAD_CLIENTE VARCHAR(25),
    PAIS_CLIENT VARCHAR(15),
    EMAIL_CLIENT VARCHAR(25),
    OBS_CLIENT VARCHAR(150),
    CODPOSTAL_CLIENT VARCHAR(8)
);

-- Tabla USUARIOS
CREATE TABLE USUARIOS (
    ID_USER VARCHAR(7) PRIMARY KEY,
    EMAIL_USER VARCHAR(25),
    PASSWORD_USER VARCHAR(20),
    NAME_USER VARCHAR(30),
    APP_USER VARCHAR(30),
    APM_USER VARCHAR(30),
    CONTAC_USER VARCHAR(15),
    ID_ROL VARCHAR(3),
    F_INGRESO_USER VARCHAR(11),
    EST_CUENTA VARCHAR(10)
);

-- Tabla VEHICULO
CREATE TABLE VEHICULO (
    PLACA_VEHICULO VARCHAR(10) PRIMARY KEY,
    RUT_CLIENT VARCHAR(10),
    MARCA_VEHICULO VARCHAR(15),
    MODELO_VEHICULO VARCHAR(15),
    ANO_VEHICULO INT,
    COLOR_VEHICULO VARCHAR(20),
    KILO_VEHICULO INT,
    ID_TIPO_VEHICULO VARCHAR(15),
    NUM_MOTO VARCHAR(30),
    OBS_VEHICULO VARCHAR(150),
    FOREIGN KEY (RUT_CLIENT) REFERENCES CLIENTE(RUT_CLIENT)
);

-- Tabla PRESUPUESTO_GENERAL
CREATE TABLE PRESUPUESTO_GENERAL (
    ID_PGEN VARCHAR(6),
    DATE_PGEN VARCHAR(10),
    ID_PESP VARCHAR(6),
    RUT_CLIENTE VARCHAR(10),
    PLACA_VEHICULO VARCHAR(10),
    VALIDEZ_PGEN INT,
    OBS_PGEN VARCHAR(150),
    PRIMARY KEY (ID_PGEN, DATE_PGEN),
    FOREIGN KEY (RUT_CLIENTE) REFERENCES CLIENTE(RUT_CLIENT),
    FOREIGN KEY (PLACA_VEHICULO) REFERENCES VEHICULO(PLACA_VEHICULO),
    FOREIGN KEY (ID_PESP) REFERENCES PRESUPUESTO_ESPECIFICO(ID_PESP)
);

-- Tabla PRESUPUESTO_ESPECIFICO
CREATE TABLE PRESUPUESTO_ESPECIFICO (
    ID_PESP VARCHAR(6) PRIMARY KEY,
    DOC_PESP BLOB,
    FIRMA_CLIENT_PESP BLOB,
    D_ECONOMICOS_PESP INT
);

-- Tabla PIEZA_PRESUPUESTADA
CREATE TABLE PIEZA_PRESUPUESTADA (
    ID_PIEZAP VARCHAR(6) PRIMARY KEY,
    ID_PRO_PIEZAS VARCHAR(6),
    ID_PESP VARCHAR(6),
    NAME_PIEZAP VARCHAR(50),
    PRECIO_PIEZAP INT,
    FOREIGN KEY (ID_PESP) REFERENCES PRESUPUESTO_ESPECIFICO(ID_PESP)
);

-- Tabla COBROS
CREATE TABLE COBROS (
    ID_COBRO VARCHAR(6) PRIMARY KEY,
    ID_PESP VARCHAR(6),
    IMPORTE_COBRO INT,
    FPAGO_COBRO VARCHAR(15),
    DATE_COBRO VARCHAR(10),
    OBS_COBRO VARCHAR(50),
    FOREIGN KEY (ID_PESP) REFERENCES PRESUPUESTO_ESPECIFICO(ID_PESP)
);

-- Tabla ORDEN_DE_INGRESO
CREATE TABLE ORDEN_DE_INGRESO (
    ID_OINGRESO VARCHAR(6) PRIMARY KEY,
    ID_RE_AC INT,
    LLAVE_INGRESO BOOLEAN,
    PERMISO_INGRESO BOOLEAN,
    REVI_INGRESO BOOLEAN,
    SG_INGRESO BOOLEAN,
    EXTIN_INGRESO BOOLEAN,
    BOTIQ_INGRESO BOOLEAN,
    TRI_INGRESO BOOLEAN,
    RR_INGRESO BOOLEAN,
    GATA_INGRESO BOOLEAN,
    BARR_INGRESO BOOLEAN,
    DS_INGRESO BOOLEAN,
    HERR_INGRESO BOOLEAN,
    ENCE_INGRESO BOOLEAN,
    PAR_INGRESO BOOLEAN,
    LLANTAS_INGRESO BOOLEAN,
    TR_INGRESO BOOLEAN,
    ESP_EX_INGRESO BOOLEAN,
    ESP_IN_INGRESO BOOLEAN,
    PLUMILLAS_INGRESO BOOLEAN,
    PISOS_INGRESO BOOLEAN,
    TAG_INGRESO BOOLEAN,
    RADIO_INGRESO BOOLEAN,
    PR_INGRESO BOOLEAN,
    AL_V_INGRESO BOOLEAN,
    CC_INGRESO BOOLEAN,
    ESP_EL_INGRESO BOOLEAN,
    ANTENA_INGRESO BOOLEAN,
    ALARM_INGRESO BOOLEAN,
    AC_INGRESO BOOLEAN,
    PARABRISAS_INGRESO BOOLEAN,
    LP_INGRESO BOOLEAN,
    LUCES_B_INGRESO BOOLEAN,
    LUCES_A_INGRESO BOOLEAN,
    LUCES_T_INGRESO BOOLEAN,
    LUCES_E_INGRESO BOOLEAN,
    SEN_INGRESO BOOLEAN,
    CAM_INGRESO BOOLEAN,
    OBS_INGRESO VARCHAR(150),
    NC_INGRESO VARCHAR(15)
);

-- Tabla ORDEN_DE_TRABAJO
CREATE TABLE ORDEN_DE_TRABAJO (
    ID_OTRABAJO VARCHAR(6) PRIMARY KEY,
    CANT_PIEZAS_OT INT,
    COMI_DESAB INT
);

-- Tabla RECEPCION_ACTIVA
CREATE TABLE RECEPCION_ACTIVA (
    ID_RE_AC INT PRIMARY KEY,
    DESC_RA VARCHAR(255),
    FIRMA BLOB,
    ID_OINGRESO VARCHAR(6),
    FOREIGN KEY (ID_OINGRESO) REFERENCES ORDEN_DE_INGRESO(ID_OINGRESO)
);

-- Tabla DETALLE_ORDEN_TRABAJO
CREATE TABLE DETALLE_ORDEN_TRABAJO (
    ID_DET_OT INT PRIMARY KEY,
    ID_EMPLEADO VARCHAR(10),
    ID_OTRABAJO VARCHAR(6),
    MOBRA_DET_OT INT,
    FOREIGN KEY (ID_EMPLEADO) REFERENCES EMPLEADO(ID_EMPLEADO),
    FOREIGN KEY (ID_OTRABAJO) REFERENCES ORDEN_DE_TRABAJO(ID_OTRABAJO)
);

-- Tabla EMPLEADO
CREATE TABLE EMPLEADO (
    ID_EMPLEADO VARCHAR(10) PRIMARY KEY,
    NOM_EMPLEADO VARCHAR(100),
    DIREC_EMPLEADO VARCHAR(100),
    COM_EMPLEADO VARCHAR(25),
    CIUD_EMPLEADO VARCHAR(25),
    NACIO_EMPLEADO VARCHAR(15),
    DATE_NACIMIENTO VARCHAR(10),
    ESTCIVIL_EMPLEADO VARCHAR(15),
    CARGO_EMPLEADO VARCHAR(20),
    GS_EMPLEADO VARCHAR(20),
    TEL_EMPLEADO VARCHAR(15),
    TEL_EMERGICIA_EM VARCHAR(15),
    PREV_EMPLEADO VARCHAR(20),
    AFP_EMPLEADO VARCHAR(20),
    CONTR_EMPLEADO VARCHAR(15),
    EMAIL_EMPLEADO VARCHAR(100),
    OBS_EMPLEADO VARCHAR(150)
);

-- Tabla CAMBIO_REGISTRADO
CREATE TABLE CAMBIO_REGISTRADO (
    ID_CAMBIO INT PRIMARY KEY,
    DATE_CAMBIO TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    ID_USER VARCHAR(7),
    FOREIGN KEY (ID_USER) REFERENCES USUARIOS(ID_USER)
);

-- Tabla PROCESO_DE_PIEZAS
CREATE TABLE PROCESO_DE_PIEZAS (
    ID_PRO_PIEZAS VARCHAR(3) PRIMARY KEY,
    DESCRIPCION_PRO VARCHAR(20)
);

-- Tabla CONSUMO_DE_INSUMOS_EN_OT
CREATE TABLE CONSUMO_DE_INSUMOS_EN_OT (
    ID_DET_OT VARCHAR(6),
    ID_INSUMOS VARCHAR(6),
    CANTIDAD INT,
    PRIMARY KEY (ID_DET_OT, ID_INSUMOS),
    FOREIGN KEY (ID_DET_OT) REFERENCES DETALLE_ORDEN_TRABAJO(ID_DET_OT),
    FOREIGN KEY (ID_INSUMOS) REFERENCES INSUMOS(ID_INSUMOS)
);

-- Tabla INSUMOS
CREATE TABLE INSUMOS (
    ID_INSUMOS VARCHAR(6) PRIMARY KEY,
    DESC VARCHAR(20),
    FORMATO VARCHAR(20),
    CADUCIDAD DATE,
    PRECIO INT,
    STOCK_MIN INT,
    STOCK_MAX INT,
    STOCK_CRI INT
);
